# ğŸ“‹Master Port Enumeration Cheat Sheet
## MSRPC (Port 135)  
### Service Enumeration 
`bash rpcdump.py <TARGET-IP>`
### Nmap Quick Check
`nmap -p135 --script=msrpc-enum <TARGET-IP>`

---
## NetBIOS/SMB (Ports 139, 445)
### Anonymous Share Check
`smbclient -L //<TARGET-IP> -N`
### Enum4Linux Quick Scan
`enum4linux-ng <TARGET-IP>`
### Nmap Vulnerability Scripts
`nmap -p139,445 --script smb-os-discovery,smb-enum-users,smb-enum-shares,smb-vuln* <TARGET-IP>`

---
## Microsoft SQL Server (Port 1433)
### Service Info Check
`nmap -sV -p1433 --script ms-sql-info <TARGET-IP>`
### Manual Login Attempt (no password)
`sqsh -S <TARGET-IP> -U sa`
### Bruteforce SQL Login (small list)
`hydra -L /usr/share/seclists/Usernames/sql-server-usernames.txt -P /usr/share/seclists/Passwords/Common-Credentials/best110.txt -t 4 -f mssql://<TARGET-IP>`

---
## RDP (Port 3389)
### Encryption Info Check
`nmap -p3389 --script rdp-enum-encryption <TARGET-IP>`
### Screenshot RDP Login (Optional)
`nmap -p3389 --script rdp-screenshot <TARGET-IP>`

---
## SQL Server Mirroring (Port 5022)
### Service Version Detection
`nmap -sV -p5022 <TARGET-IP>`
### SSL/TLS Certificate Check
`openssl s_client -connect <TARGET-IP>:5022`

---
## Barracuda BBS (Port 5120)
### Banner Grab
`nc -nv <TARGET-IP> 5120`
### Test for HTTP Service
`curl -i http://<TARGET-IP>:5120`
### Service Detection
`nmap -sV -p5120 <TARGET-IP>`

---
## WinRM (Ports 5985 and 47001)
### Confirm WinRM Service Alive
`curl -i http://<TARGET-IP>:5985/wsman curl -i http://<TARGET-IP>:47001/wsman`
### Nmap HTTP Header and Title Check
`nmap -p5985,47001 --script http-headers,http-title <TARGET-IP>`
### Remote Access via Evil-WinRM (with credentials)
`evil-winrm -i <TARGET-IP> -u <USERNAME> -p <PASSWORD>`

---
## Octopus Tentacle (Port 10934)
### Banner Grab
`nc -nv <TARGET-IP> 10934`
### Service Version Detection
`nmap -sV -p10934 <TARGET-IP>`
### SSL Certificate Check
`openssl s_client -connect <TARGET-IP>:10934`

---

## 1ï¸âƒ£ Port 53 (DNS)

### ğŸ”¹ Zone Transfer Attempt

```
dig axfr @<TARGET-IP> <domain>
```

**Look for:**

- Full DNS zone dump (hostnames, internal IPs, server names)
    
- Naming conventions that leak environment details
    
- Potential sensitive hosts (like "backup", "admin", "dev")
    

### ğŸ”¹ Basic DNS Queries

```
dig @<TARGET-IP> any <domain>
```

**Look for:**

- A records, MX records, SRV records
    
- VPN or remote-access services
    
- External-facing web apps or portals
    

> ğŸ’¡ Zone transfer = jackpot. Partial info from ANY query still helps.

---

## 2ï¸âƒ£ Port 88 (Kerberos)

### ğŸ”¹ Kerberos Pre-Auth Scan

```
nmap --script krb5-enum-users -p88 <TARGET-IP> --script-args krb5-enum-users.realm='<REALM>'
```

**Look for:**

- Usernames (especially service accounts)
    
- Accounts WITHOUT "requires pre-auth" (AS-REP roasting potential)
    

### ğŸ”¹ AS-REP Roasting

**After usernames found:**

- Try requesting TGTs without pre-auth.
    

> ğŸ’¡ Some AD misconfigs allow user enumeration even anonymously.

---

## 3ï¸âƒ£ Port 135 (MSRPC)

### ğŸ”¹ RPC Enumeration

```
rpcdump.py <TARGET-IP>
```

**Look for:**

- `efsrpc` pipe = possible PetitPotam attack
    
- `spoolss` pipe = possible PrinterBug attack
    
- `samr` = enumerate users, groups, domain info
    
- Other exposed RPC pipes
    

> ğŸ’¡ RPC is often ignored and it's a goldmine if misconfigured.

---

## 4ï¸âƒ£ Ports 139 / 445 (NetBIOS / SMB)

### ğŸ”¹ Anonymous share listing

```
smbclient -L //<TARGET-IP> -N
```

**Look for:**

- Shares allowing guest/everyone access
    
- Shares like `BACKUP`, `ADMIN$`, `C$`
    
- Sensitive filenames (passwords, backups)
    

### ğŸ”¹ Enum4Linux-ng

```
enum4linux-ng <TARGET-IP>
```

**Look for:**

- Domain/NetBIOS names
    
- User and share lists
    
- Password policies
    
- Computer accounts
    

### ğŸ”¹ Nmap SMB vuln check

```
nmap -p139,445 --script smb-enum-shares,smb-enum-users,smb-os-discovery,smb-vuln* <TARGET-IP>
```

**Look for:**

- Old vulnerabilities (MS08-067, EternalBlue, SMBGhost)
    
- SMB signing status (off = NTLM relay possible)
    

> ğŸ’¡ If SMB signing is disabled, NTLM relay is a real play.

---

## 5ï¸âƒ£ Ports 389 / 636 / 3268 / 3269 (LDAP / LDAPS / Global Catalog)

### ğŸ”¹ LDAP Search

```
ldapsearch -x -H ldap://<TARGET-IP> -b "dc=example,dc=com"
```

**Look for:**

- Users and their attributes (servicePrincipalName, pwdLastSet, description)
    
- Groups like Domain Admins
    
- Computer objects
    
- GPP password remnants
    

> ğŸ’¡ If LDAP anonymous bind works, youâ€™re inside the house.

---

## 6ï¸âƒ£ Port 464 (Kerberos Password Service)

ğŸ”¹ **Skip unless:**

- You found usernames and want to try password change abuse.
    

> ğŸ’¡ Not usually directly exploitable without credentials.

---

## 7ï¸âƒ£ Port 593 (RPC over HTTP)

### ğŸ”¹ Enumerate

```
nmap -p593 --script=rpcinfo <TARGET-IP>
```

**Look for:**

- Active HTTP RPC bindings
    
- Services like DCOM or Print Spooler
    

> ğŸ’¡ Rarely directly vulnerable, but may expose RPC pipes.

---

## 8ï¸âƒ£ Port 3389 (RDP)

### ğŸ”¹ RDP Security Settings

```
nmap -p3389 --script rdp-enum-encryption <TARGET-IP>
```

**Look for:**

- Encryption level
    
- NLA enabled or not
    
- Weak ciphers
    

### ğŸ”¹ Screenshot (optional)

```
nmap -p3389 --script rdp-screenshot <TARGET-IP>
```

**Look for:**

- Login screen info
    
- Visible domain
    

> ğŸ’¡ No NLA or weak encryption? Brute forcing may work.

---

## 9ï¸âƒ£ Port 5120 (Barracuda BBS)

### ğŸ”¹ Banner grabbing

```
nc -nv <TARGET-IP> 5120
```

**Look for:**

- Product/version info
    
- Default credential hints
    
- Vulnerable software versions
    

> ğŸ’¡ Often misconfigured or unpatched.

---

## ğŸ”Ÿ Ports 5985 / 47001 (WinRM / HTTPAPI)

### ğŸ”¹ Confirm Service

```
curl -i http://<TARGET-IP>:5985/wsman
curl -i http://<TARGET-IP>:47001/wsman
```

**Look for:**

- Auth methods (Basic, NTLM, Kerberos)
    
- Domain or hostnames
    

### ğŸ”¹ Header probing

```
nmap -p5985,47001 --script http-headers,http-title <TARGET-IP>
```

**Look for:**

- Server type and software
    
- Verbose or leaking headers
    

> ğŸ’¡ WinRM open + creds = Remote PowerShell access.

---

## 1ï¸âƒ£1ï¸âƒ£ Port 7680 (Pando / Windows Update Delivery Optimization)

### ğŸ”¹ Banner Grabbing

```
nc -nv <TARGET-IP> 7680
```

**Look for:**

- Windows Delivery Optimization
    
- Unexpected headers
    

> ğŸ’¡ Low value unless relayable or leaking.

---

## 1ï¸âƒ£2ï¸âƒ£ Port 9389 (Active Directory Web Services)

### ğŸ”¹ Enumerate if possible

```
nmap -p9389 --script adsi-search --script-args 'adsi-search.base=""' <TARGET-IP>
```

**Look for:**

- Confirm ADWS is running
    
- Try authenticated queries later if usernames found
    

> ğŸ’¡ Usually needs creds to enumerate much.

## 1ï¸âƒ£3ï¸âƒ£ Octopus Tentacle (Port 10934)
### Banner Grab
`nc -nv <TARGET-IP> 10934`
### Service Version Detection
`nmap -sV -p10934 <TARGET-IP>`
### SSL Certificate Check
`openssl s_client -connect <TARGET-IP>:10934`
